# 构建指南

## 安装需要的程序

你需要安装 [Haxe](https://haxe.org/download/) (4.2.4+，推荐版本：4.2.5), [HaxeFlixel](https://haxeflixel.com/documentation/install-haxeflixel/) (5.0.0+), and [Git](https://git-scm.com/downloads).

你也需要安装额外的依赖库，可以通过任意Haxe模块管理器或者手动安装。下面是你手动安装所需命令：
```text
haxelib install firetongue
haxelib install flxanimate
haxelib git hxCodec https://github.com/Raltyro/hxCodec.git
haxelib git discord_rpc https://github.com/Aidan63/linc_discord-rpc.git
```
如果你是Linux系统，你需要安装libvlc,如果你是Arch用户，AUR包已经过时，所以你需要安装vlc来代替
下面是在基于Ubuntu的系统上安装的例子：

```text
sudo apt-get install libvlc-dev
sudo apt-get install libvlccore-dev
```

你需要为编译游戏做好一切准备；请按下面的指南继续！
You should have everything ready for compiling the game; follow the guide below to continue!

## 编译游戏

**注意: 如果你看到deprecated packages警告，请忽视它们，那些只是警告，不影响编译。**
**注意: 使用最新的Haxe编译可能导致编译失败，推荐用Haxe 4.2.5。**
**由于上游依赖库hxCodec变动较大，会导致编译失败，故使用旧版hxCodec库**

要在你的桌面操作系统（Window,Mac,Linux）上编译它会有点复杂，你**必须**在你的平台上编译，
To compile it on your desktop (Windows, Mac, Linux) it is a bit more involved, as you ***MUST*** be on the platform that you are compiling for.

一旦编译完成，Doki Doki Takeover将自动启动。

### Windows 编译

For Windows, you need to install [Visual Studio Community 2022](https://visualstudio.microsoft.com/downloads/). 不要选择工作复杂. 相反, 去单个组件搜所以下组件:

- MSVC v143 - VS 2022 C++ x64/x86 build tools (Latest){ （MSVC v143 VS 2022 C++ x64/X86 生成工具（最新）}
- Windows 10 SDK (10.0.19041.0)

这样以后你只需要在项目文件夹打开命令行，然后执行命令`lime test windows -debug`或`haxelib run lime test windows -debug`。

要构建发行版，用`haxelib run lime build {系统} -final` {系统}写windows/linux/mac。

### Linux 编译
对于Linux,你可以用WSL2.0（Windows系统）或在Linux内核（在linux系统上）上编译。

你只需要在项目文件夹打开终端，然后执行命令`lime test linux -debug`或`haxelib lime test linux -debug`。

Linux/Windows构建打补丁：
编译完成前用/fonts-cn下字体覆盖
/export/release/linux（windows）/bin/assets/fonts即可（打包完成前）

安卓构建打补丁：
编译完成前用/fonts-cn下字体覆盖
/export/release/android/bin/app/src/main/assets/assets/fonts即可（打包完成前）


### Mac Compilation

For Mac, install Xcode and `lime test mac -debug` *should* just work; if not, the internet surely has a guide on how to compile Haxe stuff for Mac.
